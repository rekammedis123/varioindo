<!DOCTYPE html>
<html>
  <head>
    <title>Input ICD 9/10</title>
    <style>
      table, th, td {
        border: 1px solid black;
        border-collapse: collapse;
        padding: 6px;
      }
      th {
        background-color: #f2f2f2;
      }
    </style>
    <script>
      function submitICD() {
        const code = document.getElementById("icdCode").value;
        const desc = document.getElementById("icdDesc").value;

        google.script.run.withSuccessHandler(updateTable).saveICD({ code, desc });

        document.getElementById("icdCode").value = "";
        document.getElementById("icdDesc").value = "";
      }

      function deleteICD(rowIndex) {
        google.script.run.withSuccessHandler(updateTable).deleteICD(rowIndex);
      }

      function updateTable(data) {
        const table = document.getElementById("icdTable");
        table.innerHTML = `
          <tr>
            <th>No</th>
            <th>Kode ICD</th>
            <th>Deskripsi</th>
            <th>Aksi</th>
          </tr>
        `;
        data.forEach((item, i) => {
          table.innerHTML += `
            <tr>
              <td>${i + 1}</td>
              <td>${item[0]}</td>
              <td>${item[1]}</td>
              <td><button onclick="deleteICD(${i + 2})">Hapus</button></td>
            </tr>
          `;
        });
      }

      function loadICDList() {
        google.script.run.withSuccessHandler(updateTable).getICDList();
      }

      window.onload = loadICDList;
    </script>
  </head>
  <body>
    <h2>Form Input ICD 9/10</h2>
    <label>Kode ICD:</label><br />
    <input type="text" id="icdCode" /><br />
    <label>Deskripsi:</label><br />
    <input type="text" id="icdDesc" /><br /><br />
    <button onclick="submitICD()">Submit</button>

    <h3>Daftar ICD:</h3>
    <table id="icdTable"></table>
  </body>
</html>
