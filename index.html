<!DOCTYPE html>
<html>
<head>
  <title>Input ICD</title>
  <style>
    table, th, td {
      border: 1px solid black;
      border-collapse: collapse;
      padding: 6px;
    }
  </style>
</head>
<body>
  <h2>Form Input ICD</h2>
  <form id="icdForm">
    <label>Nama Pasien:</label><br>
    <input type="text" name="nama" required><br><br>

    <label>Kode ICD:</label><br>
    <input type="text" name="kodeICD" required><br><br>

    <label>Deskripsi:</label><br>
    <input type="text" name="deskripsi"><br><br>

    <button type="submit">Kirim</button>
  </form>

  <h3>ðŸ“‹ Data ICD Terkirim</h3>
  <table id="dataTable">
    <thead>
      <tr>
        <th>Timestamp</th>
        <th>Nama Pasien</th>
        <th>Kode ICD</th>
        <th>Deskripsi</th>
      </tr>
    </thead>
    <tbody></tbody>
  </table>

  <script>
    const scriptURL = "https://script.google.com/macros/s/AKfycbyWjvtY2WO2W9FoXb6zgYDfYDBD4su_CIX5JEC4FjMxMTlGDWdW73s_lJeCH6JMw6lZ4g/exec";

    function loadTable() {
      fetch(scriptURL)
        .then(res => res.json())
        .then(data => {
          const tbody = document.querySelector("#dataTable tbody");
          tbody.innerHTML = ""; // Clear existing rows
          data.forEach(row => {
            const tr = document.createElement("tr");
            tr.innerHTML = `
              <td>${new Date(row.timestamp).toLocaleString()}</td>
              <td>${row.nama}</td>
              <td>${row.kodeICD}</td>
              <td>${row.deskripsi}</td>
            `;
            tbody.appendChild(tr);
          });
        });
    }

    document.getElementById("icdForm").addEventListener("submit", function(e) {
      e.preventDefault();
      const formData = new FormData(e.target);
      fetch(scriptURL, {
        method: "POST",
        body: formData
      })
      .then(res => res.text())
      .then(msg => {
        alert("âœ… " + msg);
        loadTable(); // Refresh table
        e.target.reset(); // Clear form
      });
    });

    // Load table on page load
    window.onload = loadTable;
  </script>
</body>
</html>
